(function(n,t,i,r){"use strict";Foundation.libs.clearing={name:"clearing",version:"5.3.0",settings:{templates:{viewing:'<a href="#" class="clearing-close">&times;<\/a><div class="visible-img" style="display: none"><div class="clearing-touch-label"><\/div><img src="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs%3D" alt="" /><p class="clearing-caption"><\/p><a href="#" class="clearing-main-prev"><span><\/span><\/a><a href="#" class="clearing-main-next"><span><\/span><\/a><\/div>'},close_selectors:".clearing-close, div.clearing-blackout",open_selectors:"",touch_label:"",init:!1,locked:!1},init:function(n,t,i){var r=this;Foundation.inherit(this,"throttle image_loaded");this.bindings(t,i);r.S(this.scope).is("["+this.attr_name()+"]")?this.assemble(r.S("li",this.scope)):r.S("["+this.attr_name()+"]",this.scope).each(function(){r.assemble(r.S("li",this))})},events:function(r){var u=this,f=u.S,e=n(".scroll-container");e.length>0&&(this.scope=e);f(this.scope).off(".clearing").on("click.fndtn.clearing","ul["+this.attr_name()+"] li "+this.settings.open_selectors,function(n,t,i){var t=t||f(this),i=i||t,r=t.next("li"),e=t.closest("["+u.attr_name()+"]").data(u.attr_name(!0)+"-init"),o=f(n.target);n.preventDefault();e||(u.init(),e=t.closest("["+u.attr_name()+"]").data(u.attr_name(!0)+"-init"));i.hasClass("visible")&&t[0]===i[0]&&r.length>0&&u.is_open(t)&&(i=r,o=f("img",i));u.open(o,t,i);u.update_paddles(i)}).on("click.fndtn.clearing",".clearing-main-next",function(n){u.nav(n,"next")}).on("click.fndtn.clearing",".clearing-main-prev",function(n){u.nav(n,"prev")}).on("click.fndtn.clearing",this.settings.close_selectors,function(n){Foundation.libs.clearing.close(n,this)});n(i).on("keydown.fndtn.clearing",function(n){u.keydown(n)});f(t).off(".clearing").on("resize.fndtn.clearing",function(){u.resize()});this.swipe_events(r)},swipe_events:function(){var t=this,n=t.S;n(this.scope).on("touchstart.fndtn.clearing",".visible-img",function(t){t.touches||(t=t.originalEvent);var i={start_page_x:t.touches[0].pageX,start_page_y:t.touches[0].pageY,start_time:(new Date).getTime(),delta_x:0,is_scrolling:r};n(this).data("swipe-transition",i);t.stopPropagation()}).on("touchmove.fndtn.clearing",".visible-img",function(i){var r,u;(i.touches||(i=i.originalEvent),i.touches.length>1||i.scale&&i.scale!==1)||(r=n(this).data("swipe-transition"),typeof r=="undefined"&&(r={}),r.delta_x=i.touches[0].pageX-r.start_page_x,Foundation.rtl&&(r.delta_x=-r.delta_x),typeof r.is_scrolling=="undefined"&&(r.is_scrolling=!!(r.is_scrolling||Math.abs(r.delta_x)<Math.abs(i.touches[0].pageY-r.start_page_y))),r.is_scrolling||r.active||(i.preventDefault(),u=r.delta_x<0?"next":"prev",r.active=!0,t.nav(i,u)))}).on("touchend.fndtn.clearing",".visible-img",function(t){n(this).data("swipe-transition",{});t.stopPropagation()})},assemble:function(t){var i=t.parent(),r,u;if(!i.parent().hasClass("carousel")&&(i.after('<div id="foundationClearingHolder"><\/div>'),r=i.detach(),u="",r[0]!=null)){u=r[0].outerHTML;var o=this.S("#foundationClearingHolder"),s=i.data(this.attr_name(!0)+"-init"),e={grid:'<div class="carousel">'+u+"<\/div>",viewing:s.templates.viewing},f='<div class="clearing-assembled"><div>'+e.viewing+e.grid+"<\/div><\/div>",h=this.settings.touch_label;Modernizr.touch&&(f=n(f).find(".clearing-touch-label").html(h).end());o.after(f).remove()}},open:function(t,r,u){function l(){setTimeout(function(){this.image_loaded(o,function(){o.outerWidth()!==1||c?y.call(this,o):l.call(this)}.bind(this))}.bind(this),100)}function y(t){var i=n(t);i.css("visibility","visible");a.css("overflow","hidden");h.addClass("clearing-blackout");s.addClass("clearing-container");e.show();this.fix_height(u).caption(f.S(".clearing-caption",e),f.S("img",u)).center_and_label(t,v).shift(r,u,function(){u.closest("li").siblings().removeClass("visible");u.closest("li").addClass("visible")});e.trigger("opened.fndtn.clearing")}var f=this,a=n(i.body),h=u.closest(".clearing-assembled"),s=f.S("div",h).first(),e=f.S(".visible-img",s),o=f.S("img",e).not(t),v=f.S(".clearing-touch-label",s),c=!1;o.error(function(){c=!0});this.locked()||(e.trigger("open.fndtn.clearing"),o.attr("src",this.load(t)).css("visibility","hidden"),l.call(this))},close:function(t,r){t.preventDefault();var f=function(n){return/blackout/.test(n.selector)?n:n.closest(".clearing-blackout")}(n(r)),o=n(i.body),e,u;return r===t.target&&f&&(o.css("overflow",""),e=n("div",f).first(),u=n(".visible-img",e),u.trigger("close.fndtn.clearing"),this.settings.prev_index=0,n("ul["+this.attr_name()+"]",f).attr("style","").closest(".clearing-blackout").removeClass("clearing-blackout"),e.removeClass("clearing-container"),u.hide(),u.trigger("closed.fndtn.clearing")),!1},is_open:function(n){return n.parent().prop("style").length>0},keydown:function(t){var i=n(".clearing-blackout ul["+this.attr_name()+"]"),r=this.rtl?37:39,u=this.rtl?39:37;t.which===r&&this.go(i,"next");t.which===u&&this.go(i,"prev");t.which===27&&this.S("a.clearing-close").trigger("click").trigger("click.fndtn.clearing")},nav:function(t,i){var r=n("ul["+this.attr_name()+"]",".clearing-blackout");t.preventDefault();this.go(r,i)},resize:function(){var t=n("img",".clearing-blackout .visible-img"),i=n(".clearing-touch-label",".clearing-blackout");t.length&&(this.center_and_label(t,i),t.trigger("resized.fndtn.clearing"))},fix_height:function(n){var t=n.parent().children(),i=this;return t.each(function(){var n=i.S(this),t=n.find("img");n.height()>t.outerHeight()&&n.addClass("fix-height")}).closest("ul").width(t.length*100+"%"),this},update_paddles:function(n){n=n.closest("li");var t=n.closest(".carousel").siblings(".visible-img");n.next().length>0?this.S(".clearing-main-next",t).removeClass("disabled"):this.S(".clearing-main-next",t).addClass("disabled");n.prev().length>0?this.S(".clearing-main-prev",t).removeClass("disabled"):this.S(".clearing-main-prev",t).addClass("disabled")},center_and_label:function(n,t){return this.rtl?(n.css({marginRight:-(n.outerWidth()/2),marginTop:-(n.outerHeight()/2),left:"auto",right:"50%"}),t.length>0&&t.css({marginRight:-(t.outerWidth()/2),marginTop:-(n.outerHeight()/2)-t.outerHeight()-10,left:"auto",right:"50%"})):(n.css({marginLeft:-(n.outerWidth()/2),marginTop:-(n.outerHeight()/2)}),t.length>0&&t.css({marginLeft:-(t.outerWidth()/2),marginTop:-(n.outerHeight()/2)-t.outerHeight()-10})),this},load:function(n){var t;return(t=n[0].nodeName==="A"?n.attr("href"):n.parent().attr("href"),this.preload(n),t)?t:n.attr("src")},preload:function(n){this.img(n.closest("li").next()).img(n.closest("li").prev())},img:function(n){if(n.length){var i=new Image,t=this.S("a",n);i.src=t.length?t.attr("href"):this.S("img",n).attr("src")}return this},caption:function(n,t){var i=t.attr("data-caption");return i?n.html(i).show():n.text("").hide(),this},go:function(n,t){var r=this.S(".visible",n),i=r[t]();i.length&&this.S("img",i).trigger("click",[r,i]).trigger("click.fndtn.clearing",[r,i]).trigger("change.fndtn.clearing")},shift:function(n,t,i){var u=t.parent(),c=this.settings.prev_index||t.index(),f=this.direction(u,n,t),e=this.rtl?"right":"left",h=parseInt(u.css("left"),10),o=t.outerWidth(),s,r={};t.index()===c||/skip/.test(f)?/skip/.test(f)&&(s=t.index()-this.settings.up_count,this.lock(),s>0?(r[e]=-(s*o),u.animate(r,300,this.unlock())):(r[e]=0,u.animate(r,300,this.unlock()))):/left/.test(f)?(this.lock(),r[e]=h+o,u.animate(r,300,this.unlock())):/right/.test(f)&&(this.lock(),r[e]=h-o,u.animate(r,300,this.unlock()));i()},direction:function(n,t,i){var u=this.S("li",n),o=u.outerWidth()+u.outerWidth()/4,f=Math.floor(this.S(".clearing-container").outerWidth()/o)-1,r=u.index(i),e;return this.settings.up_count=f,e=this.adjacent(this.settings.prev_index,r)?r>f&&r>this.settings.prev_index?"right":r>f-1&&r<=this.settings.prev_index?"left":!1:"skip",this.settings.prev_index=r,e},adjacent:function(n,t){for(var i=t+1;i>=t-1;i--)if(i===n)return!0;return!1},lock:function(){this.settings.locked=!0},unlock:function(){this.settings.locked=!1},locked:function(){return this.settings.locked},off:function(){this.S(this.scope).off(".fndtn.clearing");this.S(t).off(".fndtn.clearing")},reflow:function(){this.init()}}})(jQuery,window,window.document);