function dashboard(n,t,i){i.RecentQuotes=[];i.Surveys=[];i.Messages=[];i.MovingToday=[];i.QuotesStats=[];i.LeadCount=0;i.StorageCount=0;i.Jobs=[];i.Leads=[];i.WebQuote=[];i.newMessage="";i.GetDashboardData=function(){n.GetDashboardData().then(function(n){i.MovingToday=n.todays;i.RecentQuotes=n.quotes;i.Surveys=n.surveyJson;i.Messages=n.msgs;i.LeadCount=i.$parent.Leads.length},function(){alert("er")})};i.GetSurveys=function(){n.Surveys().then(function(n){i.Surveys=n},function(){alert("er")})};i.GetMessages=function(){n.Messages().then(function(n){i.Messages=n},function(){alert("er")})};i.addNewMessage=function(t){n.addNewMessage(t).then(function(n){i.Messages=n;i.newMessage=""},function(){alert("er")})};i.removeMessage=function(t){n.removeMessage(t).then(function(n){i.Messages=n},function(){alert("er")})};i.MovingToday=function(){n.MovingToday().then(function(n){for(var r,u=24,f=0,e=0,t=0;t<n.length;t++){for(r=0;r<n[t].Schedules.length;r++)n[t].Schedules[r].StartTime<u&&(u=n[t].Schedules[r].StartTime),n[t].Schedules[r].EndTime>f&&(f=n[t].Schedules[r].EndTime),e+=n[t].Schedules[r].Movers;n[t].StartTime=u;n[t].EndTime=f;n[t].Movers=e}i.MovingToday=n},function(){alert("er")})};i.GetStorageCount=function(){n.GetStorageCount().then(function(n){i.StorageCount=n},function(){alert("er")})};i.GetStats=function(){n.GetQuoteStats("").then(function(n){i.QuotesStats.Open=[];i.QuotesStats.Scheduled=[];i.QuotesStats.Lost=[];i.QuotesStats.Won=[];i.QuotesStats.Open.SubStatuses=[];i.QuotesStats.Open.SubStatuses.Expired=[];i.QuotesStats.Open.SubStatuses.Unassigned=[];i.QuotesStats.Open.Count=n.OpenCount;i.QuotesStats.Open.Amount=n.OpenAmount;i.QuotesStats.Scheduled.Count=n.ScheduledCount;i.QuotesStats.Scheduled.Amount=n.ScheduledAmount;i.QuotesStats.Lost.Amount=n.Lost30DaysAmount;i.QuotesStats.Lost.Count=n.Lost30DaysCount;i.QuotesStats.Won.Count=n.Won30DaysCount;i.QuotesStats.Won.Amount=n.Won30DaysAmount;i.QuotesStats.Open.SubStatuses.Expired.Count=n.ExpiringCount;i.QuotesStats.Open.SubStatuses.Unassigned.Count=n.UnassignedCount},function(){})};i.GetJobsForUser=function(){n.GetJobsForUser().then(function(n){i.Jobs.Booked=n.Booked;i.Jobs.Posted=n.Posted},function(){alert("er")})};i.Init=function(){i.GetDashboardData();i.GetStats();i.GetStorageCount();i.GetJobsForUser()};i.Init()}quoteApp.controller("dashboard",["homeFactory","$timeout","$scope",dashboard]);