(function(n){"use strict";function i(){var i=t.clientHeight,r=n.innerHeight;return i<r?r:i}function r(){return n.pageYOffset||t.scrollTop}function e(n){var t=0,i=0;do isNaN(n.offsetTop)||(t+=n.offsetTop),isNaN(n.offsetLeft)||(i+=n.offsetLeft);while(n=n.offsetParent);return{top:t,left:i}}function u(n,t){var u=n.offsetHeight,f=r(),s=f+i(),o=e(n).top,h=o+u,t=t||0;return o+u*t<=s&&h-u*t>=f}function o(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);return n}function f(n,t){this.el=n;this.options=o(this.defaults,t);this._init()}var t=n.document.documentElement;f.prototype={defaults:{minDuration:0,maxDuration:0,viewportFactor:0},_init:function(){this.items=Array.prototype.slice.call(document.querySelectorAll("#"+this.el.id+" > li"));this.itemsCount=this.items.length;this.itemsRenderedCount=0;this.didScroll=!1;var t=this;imagesLoaded(this.el,function(){new Masonry(t.el,{itemSelector:"li",transitionDuration:0});Modernizr.cssanimations&&(t.items.forEach(function(n){u(n)&&(t._checkTotalRendered(),classie.add(n,"shown"))}),n.addEventListener("scroll",function(){t._onScrollFn()},!1),n.addEventListener("resize",function(){t._resizeHandler()},!1))})},_onScrollFn:function(){var n=this;this.didScroll||(this.didScroll=!0,setTimeout(function(){n._scrollPage()},60))},_scrollPage:function(){var n=this;this.items.forEach(function(t){classie.has(t,"shown")||classie.has(t,"animate")||!u(t,n.options.viewportFactor)||setTimeout(function(){var f=r()+i()/2,u;n.el.style.WebkitPerspectiveOrigin="50% "+f+"px";n.el.style.MozPerspectiveOrigin="50% "+f+"px";n.el.style.perspectiveOrigin="50% "+f+"px";n._checkTotalRendered();n.options.minDuration&&n.options.maxDuration&&(u=Math.random()*(n.options.maxDuration-n.options.minDuration)+n.options.minDuration+"s",t.style.WebkitAnimationDuration=u,t.style.MozAnimationDuration=u,t.style.animationDuration=u);classie.add(t,"animate")},25)});this.didScroll=!1},_resizeHandler:function(){function t(){n._scrollPage();n.resizeTimeout=null}var n=this;this.resizeTimeout&&clearTimeout(this.resizeTimeout);this.resizeTimeout=setTimeout(t,1e3)},_checkTotalRendered:function(){++this.itemsRenderedCount;this.itemsRenderedCount===this.itemsCount&&n.removeEventListener("scroll",this._onScrollFn)}};n.AnimOnScroll=f})(window);