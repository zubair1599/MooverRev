CKEDITOR.plugins.add("colorbutton",{requires:"panelbutton,floatpanel",lang:"af,ar,bg,bn,bs,ca,cs,cy,da,de,el,en,en-au,en-ca,en-gb,eo,es,et,eu,fa,fi,fo,fr,fr-ca,gl,gu,he,hi,hr,hu,id,is,it,ja,ka,km,ko,ku,lt,lv,mk,mn,ms,nb,nl,no,pl,pt,pt-br,ro,ru,si,sk,sl,sq,sr,sr-latn,sv,th,tr,ug,uk,vi,zh,zh-cn",icons:"bgcolor,textcolor",hidpi:!0,init:function(n){function r(r,u,e,o){var s=new CKEDITOR.style(i["colorButton_"+u+"Style"]),h=CKEDITOR.tools.getNextId()+"_colorBox";n.ui.add(r,CKEDITOR.UI_PANELBUTTON,{label:e,title:e,modes:{wysiwyg:1},editorFocus:1,toolbar:"colors,"+o,allowedContent:s,requiredContent:s,panel:{css:CKEDITOR.skin.getPath("editor"),attributes:{role:"listbox","aria-label":t.panelTitle}},onBlock:function(t,i){i.autoSize=!0;i.element.addClass("cke_colorblock");i.element.setHtml(f(t,u,h));i.element.getDocument().getBody().setStyle("overflow","hidden");CKEDITOR.ui.fire("ready",this);var r=i.keys,e="rtl"==n.lang.dir;r[e?37:39]="next";r[40]="next";r[9]="next";r[e?39:37]="prev";r[38]="prev";r[CKEDITOR.SHIFT+9]="prev";r[32]="click"},onOpen:function(){var t=n.getSelection(),t=t&&t.getStartElement(),t=n.elementPath(t),i,t=t.block||t.blockLimit||n.document.getBody();do i=t&&t.getComputedStyle("back"==u?"background-color":"color")||"transparent";while("back"==u&&"transparent"==i&&t&&(t=t.getParent()));return i&&"transparent"!=i||(i="#ffffff"),this._.panel._.iframe.getFrameDocument().getById(h).setStyle("background-color",i),i}})}function f(r,f,e){var o=[],a=i.colorButton_colors.split(","),c=CKEDITOR.tools.addFunction(function(t,f){var s,e,o;"?"==t?(s=arguments.callee,e=function(n){this.removeListener("ok",e);this.removeListener("cancel",e);"ok"==n.name&&s(this.getContentElement("picker","selectedColor").getValue(),f)},n.openDialog("colordialog",function(){this.on("ok",e);this.on("cancel",e)})):(n.focus(),r.hide(),n.fire("saveSnapshot"),n.removeStyle(new CKEDITOR.style(i["colorButton_"+f+"Style"],{color:"inherit"})),t&&(o=i["colorButton_"+f+"Style"],o.childRule="back"==f?function(n){return u(n)}:function(n){return!(n.is("a")||n.getElementsByTag("a").count())||u(n)},n.applyStyle(new CKEDITOR.style(o,{color:t}))),n.fire("saveSnapshot"))});for(o.push('<a class="cke_colorauto" _cke_focus=1 hidefocus=true title="',t.auto,'" onclick="CKEDITOR.tools.callFunction(',c,",null,'",f,"');return false;\" href=\"javascript:void('",t.auto,'\')" role="option"><table role="presentation" cellspacing=0 cellpadding=0 width="100%"><tr><td><span class="cke_colorbox" id="',e,'"><\/span><\/td><td colspan=7 align=center>',t.auto,'<\/td><\/tr><\/table><\/a><table role="presentation" cellspacing=0 cellpadding=0 width="100%">'),e=0;e<a.length;e++){0==e%8&&o.push("<\/tr><tr>");var s=a[e].split("/"),h=s[0],l=s[1]||h;s[1]||(h="#"+h.replace(/^(.)(.)(.)$/,"$1$1$2$2$3$3"));s=n.lang.colorbutton.colors[l]||l;o.push('<td><a class="cke_colorbox" _cke_focus=1 hidefocus=true title="',s,'" onclick="CKEDITOR.tools.callFunction(',c,",'",h,"','",f,"'); return false;\" href=\"javascript:void('",s,'\')" role="option"><span class="cke_colorbox" style="background-color:#',l,'"><\/span><\/a><\/td>')}return(n.plugins.colordialog&&void 0===i.colorButton_enableMore||i.colorButton_enableMore)&&o.push('<\/tr><tr><td colspan=8 align=center><a class="cke_colormore" _cke_focus=1 hidefocus=true title="',t.more,'" onclick="CKEDITOR.tools.callFunction(',c,",'?','",f,"');return false;\" href=\"javascript:void('",t.more,"')\"",' role="option">',t.more,"<\/a><\/td>"),o.push("<\/tr><\/table>"),o.join("")}function u(n){return"false"==n.getAttribute("contentEditable")||n.getAttribute("data-nostyle")}var i=n.config,t=n.lang.colorbutton;CKEDITOR.env.hc||(r("TextColor","fore",t.textColorTitle,10),r("BGColor","back",t.bgColorTitle,20))}});CKEDITOR.config.colorButton_colors="000,800000,8B4513,2F4F4F,008080,000080,4B0082,696969,B22222,A52A2A,DAA520,006400,40E0D0,0000CD,800080,808080,F00,FF8C00,FFD700,008000,0FF,00F,EE82EE,A9A9A9,FFA07A,FFA500,FFFF00,00FF00,AFEEEE,ADD8E6,DDA0DD,D3D3D3,FFF0F5,FAEBD7,FFFFE0,F0FFF0,F0FFFF,F0F8FF,E6E6FA,FFF";CKEDITOR.config.colorButton_foreStyle={element:"span",styles:{color:"#(color)"},overrides:[{element:"font",attributes:{color:null}}]};CKEDITOR.config.colorButton_backStyle={element:"span",styles:{"background-color":"#(color)"}};