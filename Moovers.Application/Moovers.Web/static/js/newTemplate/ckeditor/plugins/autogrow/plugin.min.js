(function(){function t(n){var n=n.document,t=n.getBody(),i=n.getDocumentElement();return"BackCompat"==n.$.compatMode?t:i}var n=function(n,i){var u,o,r,e,f;return n.window?(u=n.getCommand("maximize"),u&&u.state==CKEDITOR.TRISTATE_ON)?null:(u=t(n),o=n.window.getViewPaneSize().height,r=u.getStyle("overflow-y"),e=u.getDocument(),f=CKEDITOR.dom.element.createFromHtml('<span style="margin:0;padding:0;border:0;clear:both;width:1px;height:1px;display:block;">'+(CKEDITOR.env.webkit?"&nbsp;":"")+"<\/span>",e),e[CKEDITOR.env.ie?"getBody":"getDocumentElement"]().append(f),e=f.getDocumentPosition(e).y+f.$.offsetHeight,f.remove(),u.setStyle("overflow-y",r),r=e+(n.config.autoGrow_bottomSpace||0),f=n.config.autoGrow_maxHeight||Infinity,r=Math.max(r,void 0!=n.config.autoGrow_minHeight?n.config.autoGrow_minHeight:200),r=Math.min(r,f),r!=o&&i!=r&&(r=n.fire("autoGrow",{currentHeight:o,newHeight:r}).newHeight,n.resize(n.container.getStyle("width"),r,!0),i=r),u.$.scrollHeight>u.$.clientHeight&&r<f?u.setStyle("overflow-y","hidden"):u.removeStyle("overflow-y"),i):null};CKEDITOR.plugins.add("autogrow",{init:function(i){if(i.elementMode!=CKEDITOR.ELEMENT_MODE_INLINE)i.on("instanceReady",function(){var r,u,f;if(i.editable().isInline())i.ui.space("contents").setStyle("height","auto");else{i.addCommand("autogrow",{exec:function(t){r=n(t,r)},modes:{wysiwyg:1},readOnly:1,canUndo:!1,editorFocus:!1});u={contentDom:1,key:1,selectionChange:1,insertElement:1,mode:1};for(f in u)i.on(f,function(t){"wysiwyg"==t.editor.mode&&setTimeout(function(){r=n(t.editor,r);r=n(t.editor,r)},100)});i.on("afterCommandExec",function(u){"maximize"==u.data.name&&"wysiwyg"==u.editor.mode&&(u.data.command.state==CKEDITOR.TRISTATE_ON?t(i).removeStyle("overflow"):r=n(i,r))});i.config.autoGrow_onStartup&&i.execCommand("autogrow")}})}})})();