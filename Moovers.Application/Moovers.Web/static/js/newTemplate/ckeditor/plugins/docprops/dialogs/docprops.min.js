CKEDITOR.dialog.add("docProps",function(n){function c(t,i){var u=function(){r(this);i(this,this._.parentDialog)},r=function(n){n.removeListener("ok",u);n.removeListener("cancel",r)},f=function(n){n.on("ok",u);n.on("cancel",r)};if(n.execCommand(t),n._.storedDialogs.colordialog)f(n._.storedDialogs.colordialog);else CKEDITOR.on("dialogDefinition",function(n){if(n.data.name==t){var i=n.data.definition;n.removeListener();i.onLoad=CKEDITOR.tools.override(i.onLoad,function(n){return function(){f(this);i.onLoad=n;"function"==typeof n&&n.call(this)}})}})}function e(){var n=this.getDialog().getContentElement("general",this.id+"Other");n&&("other"==this.getValue()?(n.getInputElement().removeAttribute("readOnly"),n.focus(),n.getElement().removeClass("cke_disabled")):(n.getInputElement().setAttribute("readOnly",!0),n.getElement().addClass("cke_disabled")))}function u(t,i,u){return function(f,e,o){e=r;f="undefined"!=typeof u?u:this.getValue();!f&&t in e?e[t].remove():f&&t in e?e[t].setAttribute("content",f):f&&(e=new CKEDITOR.dom.element("meta",n.document),e.setAttribute(i?"http-equiv":"name",t),e.setAttribute("content",f),o.append(e))}}function f(n,t){return function(){var i=r,i=n in i?i[n].getAttribute("content")||"":"";return t?i:(this.setValue(i),null)}}function o(n){return function(t,i,r,u){u.removeAttribute("margin"+n);t=this.getValue();""!==t?u.setStyle("margin-"+n,CKEDITOR.tools.cssLength(t)):u.removeStyle("margin-"+n)}}function s(n,t,i){n.removeStyle(t);n.getComputedStyle(t)!=i&&n.setStyle(t,i)}var t=n.lang.docprops,i=n.lang.common,r={},h=function(n,i,r){return{type:"hbox",padding:0,widths:["60%","40%"],children:[CKEDITOR.tools.extend({type:"text",id:n,label:t[i]},r||{},1),{type:"button",id:n+"Choose",label:t.chooseColor,className:"colorChooser",onClick:function(){var t=this;c("colordialog",function(i){var r=t.getDialog();r.getContentElement(r._.currentTabId,n).setValue(i.getContentElement("picker","selectedColor").getValue())})}}]}},l="javascript:void((function(){"+encodeURIComponent("document.open();"+(CKEDITOR.env.ie?"("+CKEDITOR.tools.fixDomain+")();":"")+'document.write( \'<html style="background-color: #ffffff; height: 100%"><head><\/head><body style="width: 100%; height: 100%; margin: 0px">'+t.previewHtml+"<\/body><\/html>' );document.close();")+"})())";return{title:t.title,minHeight:330,minWidth:500,onShow:function(){for(var i,t=n.document,o=t.getElementsByTag("html").getItem(0),s=t.getHead(),h=t.getBody(),f={},e=t.getElementsByTag("meta"),c=e.count(),u=0;u<c;u++)i=e.getItem(u),f[i.getAttribute(i.hasAttribute("http-equiv")?"http-equiv":"name").toLowerCase()]=i;r=f;this.setupContent(t,o,s,h)},onHide:function(){r={}},onOk:function(){var t=n.document,i=t.getElementsByTag("html").getItem(0),r=t.getHead(),u=t.getBody();this.commitContent(t,i,r,u)},contents:[{id:"general",label:i.generalTab,elements:[{type:"text",id:"title",label:t.docTitle,setup:function(n){this.setValue(n.getElementsByTag("title").getItem(0).data("cke-title"))},commit:function(n,t,i,r,u){u||n.getElementsByTag("title").getItem(0).data("cke-title",this.getValue())}},{type:"hbox",children:[{type:"select",id:"dir",label:i.langDir,style:"width: 100%",items:[[i.notSet,""],[i.langDirLtr,"ltr"],[i.langDirRtl,"rtl"]],setup:function(n,t,i,r){this.setValue(r.getDirection()||"")},commit:function(n,t,i,r){(n=this.getValue())?r.setAttribute("dir",n):r.removeAttribute("dir");r.removeStyle("direction")}},{type:"text",id:"langCode",label:i.langCode,setup:function(n,t){this.setValue(t.getAttribute("xml:lang")||t.getAttribute("lang")||"")},commit:function(n,t,i,r,u){u||((n=this.getValue())?t.setAttributes({"xml:lang":n,lang:n}):t.removeAttributes({"xml:lang":1,lang:1}))}}]},{type:"hbox",children:[{type:"select",id:"charset",label:t.charset,style:"width: 100%",items:[[i.notSet,""],[t.charsetASCII,"us-ascii"],[t.charsetCE,"iso-8859-2"],[t.charsetCT,"big5"],[t.charsetCR,"iso-8859-5"],[t.charsetGR,"iso-8859-7"],[t.charsetJP,"iso-2022-jp"],[t.charsetKR,"iso-2022-kr"],[t.charsetTR,"iso-8859-9"],[t.charsetUN,"utf-8"],[t.charsetWE,"iso-8859-1"],[t.other,"other"]],"default":"",onChange:function(){this.getDialog().selectedCharset="other"!=this.getValue()?this.getValue():"";e.call(this)},setup:function(){var n,t;this.metaCharset="charset"in r;n=f(this.metaCharset?"charset":"content-type",1,1).call(this);!this.metaCharset&&n.match(/charset=[^=]+$/)&&(n=n.substring(n.indexOf("=")+1));n&&(this.setValue(n.toLowerCase()),this.getValue()||(this.setValue("other"),t=this.getDialog().getContentElement("general","charsetOther"),t&&t.setValue(n)),this.getDialog().selectedCharset=n);e.call(this)},commit:function(n,t,i,f,e){e||(f=this.getValue(),e=this.getDialog().getContentElement("general","charsetOther"),"other"==f&&(f=e?e.getValue():""),f&&!this.metaCharset&&(f=(r["content-type"]?r["content-type"].getAttribute("content").split(";")[0]:"text/html")+"; charset="+f),u(this.metaCharset?"charset":"content-type",1,f).call(this,n,t,i))}},{type:"text",id:"charsetOther",label:t.charsetOther,onChange:function(){this.getDialog().selectedCharset=this.getValue()}}]},{type:"hbox",children:[{type:"select",id:"docType",label:t.docType,style:"width: 100%",items:[[i.notSet,""],["XHTML 1.1",'<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN" "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">'],["XHTML 1.0 Transitional",'<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">'],["XHTML 1.0 Strict",'<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">'],["XHTML 1.0 Frameset",'<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Frameset//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-frameset.dtd">'],["HTML 5","<!DOCTYPE html>"],["HTML 4.01 Transitional",'<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">'],["HTML 4.01 Strict",'<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">'],["HTML 4.01 Frameset",'<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Frameset//EN" "http://www.w3.org/TR/html4/frameset.dtd">'],["HTML 3.2",'<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">'],["HTML 2.0",'<!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML//EN">'],[t.other,"other"]],onChange:e,setup:function(){if(n.docType&&(this.setValue(n.docType),!this.getValue())){this.setValue("other");var t=this.getDialog().getContentElement("general","docTypeOther");t&&t.setValue(n.docType)}e.call(this)},commit:function(t,i,r,u,f){f||(t=this.getValue(),i=this.getDialog().getContentElement("general","docTypeOther"),n.docType="other"==t?i?i.getValue():"":t)}},{type:"text",id:"docTypeOther",label:t.docTypeOther}]},{type:"checkbox",id:"xhtmlDec",label:t.xhtmlDec,setup:function(){this.setValue(!!n.xmlDeclaration)},commit:function(t,i,r,u,f){f||(this.getValue()?(n.xmlDeclaration='<?xml version="1.0" encoding="'+(this.getDialog().selectedCharset||"utf-8")+'"?>',i.setAttribute("xmlns","http://www.w3.org/1999/xhtml")):(n.xmlDeclaration="",i.removeAttribute("xmlns")))}}]},{id:"design",label:t.design,elements:[{type:"hbox",widths:["60%","40%"],children:[{type:"vbox",children:[h("txtColor","txtColor",{setup:function(n,t,i,r){this.setValue(r.getComputedStyle("color"))},commit:function(n,t,i,r,u){(this.isChanged()||u)&&(r.removeAttribute("text"),(n=this.getValue())?r.setStyle("color",n):r.removeStyle("color"))}}),h("bgColor","bgColor",{setup:function(n,t,i,r){n=r.getComputedStyle("background-color")||"";this.setValue("transparent"==n?"":n)},commit:function(n,t,i,r,u){(this.isChanged()||u)&&(r.removeAttribute("bgcolor"),(n=this.getValue())?r.setStyle("background-color",n):s(r,"background-color","transparent"))}}),{type:"hbox",widths:["60%","40%"],padding:1,children:[{type:"text",id:"bgImage",label:t.bgImage,setup:function(n,t,i,r){n=r.getComputedStyle("background-image")||"";n="none"==n?"":n.replace(/url\(\s*(["']?)\s*([^\)]*)\s*\1\s*\)/i,function(n,t,i){return i});this.setValue(n)},commit:function(n,t,i,r){r.removeAttribute("background");(n=this.getValue())?r.setStyle("background-image","url("+n+")"):s(r,"background-image","none")}},{type:"button",id:"bgImageChoose",label:i.browseServer,style:"display:inline-block;margin-top:10px;",hidden:!0,filebrowser:"design:bgImage"}]},{type:"checkbox",id:"bgFixed",label:t.bgFixed,setup:function(n,t,i,r){this.setValue("fixed"==r.getComputedStyle("background-attachment"))},commit:function(n,t,i,r){this.getValue()?r.setStyle("background-attachment","fixed"):s(r,"background-attachment","scroll")}}]},{type:"vbox",children:[{type:"html",id:"marginTitle",html:'<div style="text-align: center; margin: 0px auto; font-weight: bold">'+t.margin+"<\/div>"},{type:"text",id:"marginTop",label:t.marginTop,style:"width: 80px; text-align: center",align:"center",inputStyle:"text-align: center",setup:function(n,t,i,r){this.setValue(r.getStyle("margin-top")||r.getAttribute("margintop")||"")},commit:o("top")},{type:"hbox",children:[{type:"text",id:"marginLeft",label:t.marginLeft,style:"width: 80px; text-align: center",align:"center",inputStyle:"text-align: center",setup:function(n,t,i,r){this.setValue(r.getStyle("margin-left")||r.getAttribute("marginleft")||"")},commit:o("left")},{type:"text",id:"marginRight",label:t.marginRight,style:"width: 80px; text-align: center",align:"center",inputStyle:"text-align: center",setup:function(n,t,i,r){this.setValue(r.getStyle("margin-right")||r.getAttribute("marginright")||"")},commit:o("right")}]},{type:"text",id:"marginBottom",label:t.marginBottom,style:"width: 80px; text-align: center",align:"center",inputStyle:"text-align: center",setup:function(n,t,i,r){this.setValue(r.getStyle("margin-bottom")||r.getAttribute("marginbottom")||"")},commit:o("bottom")}]}]}]},{id:"meta",label:t.meta,elements:[{type:"textarea",id:"metaKeywords",label:t.metaKeywords,setup:f("keywords"),commit:u("keywords")},{type:"textarea",id:"metaDescription",label:t.metaDescription,setup:f("description"),commit:u("description")},{type:"text",id:"metaAuthor",label:t.metaAuthor,setup:f("author"),commit:u("author")},{type:"text",id:"metaCopyright",label:t.metaCopyright,setup:f("copyright"),commit:u("copyright")}]},{id:"preview",label:i.preview,elements:[{type:"html",id:"previewHtml",html:'<iframe src="'+l+'" style="width: 100%; height: 310px" hidefocus="true" frameborder="0" id="cke_docProps_preview_iframe"><\/iframe>',onLoad:function(){this.getDialog().on("selectPage",function(n){if("preview"==n.data.page){var t=this;setTimeout(function(){var n=CKEDITOR.document.getById("cke_docProps_preview_iframe").getFrameDocument(),i=n.getElementsByTag("html").getItem(0),r=n.getHead(),u=n.getBody();t.commitContent(n,i,r,u,1)},50)}});CKEDITOR.document.getById("cke_docProps_preview_iframe").getAscendant("table").setStyle("height","100%")}}]}]}});